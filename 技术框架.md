# 技术框架介绍 #

##原有的网络部署##


![原有的技术框架](http://www.gliffy.com/go/publish/image/5789344/L.png)

原有的技术方案以及网络架构大体如上图所示：

我们在教委有中心服务器，部署我们的应用以及数据库，文件服务器。使用人员，包括老师，学生，教研员等都直接访问中心服务器，获取信息，存储信息。也就是传统的J2EE程序，android端与pc端都是通过http访问获得应答。

当访问量变大之后，并发解决的不好，导致可用性变得很差，因此，处于缓解压力的考虑，我们将一个中心服务器模式改成了，以中心服务器为核心，每个学校部署自己的服务器为辅的形式。学校内的老师，学生的访问被转到学校服务器，这样，减轻了大量访问中心服务器的压力。

但是这就产生了两个服务器的信息同步问题，包括应用程序，数据库数据，文件系统等多种信息，需要保持同步。同步历来是各个公司非常头疼的问题，因为同步会涉及到故障问题非常多，恢复，差错查找都是非常困难，因此，一般能避免则尽量避免。

细节技术上，开发语言采用java，数据库采用mysql，采用ejb3的技术。前端没有太多修饰，直接由jsp渲染出html，很少使用ajax，几乎所有的请求都会刷新页面。

老师端使用的是PC，通过浏览器直接访问系统，备课过程中使用doc等文件，通过activex插件解决，因此，可能要求浏览器必须使用ie。

学生端使用平板电脑，系统为android4.x，内建电子书包程序，通过http请求，内嵌webview展现内容。

由于看不到更详细的细节，不知道是否有apache或者nginx这样的反向代理，是否有cache，mysql是否有主从等，这次不做深入探讨，等待后期认识清楚后重新修改这部分。




##新技术架构##

新框架充分考虑到原有框架在实际使用中出现的问题，以及为了未来更多地区使用的情形，建立起来的一整套技术方案，从网络拓扑到技术细节，以下逐一列出。

参考[高性能网站建设指南](http://baike.baidu.com/view/2573224.htm?fr=aladdin)的建议，结合目前主流的一些开发思路，我们倾向选择html+json+j2ee的形式进行开发。

###后端技术###

- springmvc
- sitemesh
- spring security
- hibernate
- ehcache(其他cache也可以）
- thrift
- tomcat 7
- mongodb
- redis
- openoffice

server端采用java开发，server提供json数据，不提供页面render，通俗点说就是不用jsp，freemarker，volecity，jsf等技术

###前端技术###

前端技术是这次开发重点涉及的地方，html5的大量使用，使得前端的技术，复杂度，业务逻辑都复杂了很多。

- bootstrap3.1
- jquery1.10.x
- jquery plugin(日历，树等，文件上传)
- backbonejs
- underscorejs
- css3
- websocket
- canvas (用于手绘)
- js game engine (用于课件开发)

###其他###

- nodejs
- node-webkit(c/s开发）
- python（运维）

重点提及一下nodejs，在这次开发中，nodejs是有些分量的，对于核心的业务逻辑，我们交给java开发，而简单的工具型的，可以由nodejs开发。具体细节我另起文章介绍。


新的架构的网络模型如下
![3.0架构](http://www.gliffy.com/go/publish/image/5795010/L.png)

可以看到新的结构要简单很多，其主要原因是加强老师电脑在上课过程中起到的作用。
严格来说，老师上一次课，所有的学生只要和老师组成一个局域网，基本就可以把课上全，即使对整个外网是断了连接的。只要老师的资源，学案是全部的，学生的自然可以在这个环境内把课上完。

其次，新的方案大量采用html5的技术，无论是android还是pc端，页面的内容是可以缓存在本地，而数据是可以从服务器端获取。在一般时段，所有人都可以向服务器获取资源，对于上个这个特殊场景，完全可以由老师下载所需的资源，学生全部从老师的机器上获取资源，快速而有效。

